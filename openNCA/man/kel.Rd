% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kel.R
\name{kel}
\alias{kel}
\alias{kelc0}
\alias{keltmlo}
\alias{keltmhi}
\alias{kelnopt}
\alias{thalf}
\title{Terminal or Elimination phase rate constant}
\usage{
kel(conc = NULL, time = NULL, exflag = NULL)
}
\arguments{
\item{conc}{The concentration data (given in a vector form)}

\item{time}{The time data (given in a vector form)}
}
\description{
This function gets the terminal or elimination phase rate constant, which is described as the absolute
value of the slope of a least-squares linear regression during the terminal phase of the natural-logarithm
(ln) transformed concentration-time profile. The function also gets the the intercept on natural log of 
plasma drug concentration axis (KELC0), the corresponding values of initial timepoint used in the calculation 
of kel (KELTMLO), final timepoint used in the calculation of kel (KELTMHI), number of timepoints used in 
the calculation of kel (KELNOPT), and the terminal phase half-life (THALF)
}
\details{
\strong{First calculate slope} \cr  
\figure{kel_eq1.png} \cr
\figure{kel_eq2.png} \cr
\figure{kel_eq3.png} \cr
\figure{kel_eq0.png} \cr
\eqn{S = Slope} \cr
\eqn{b = KELC0 (the y intercept)} \cr
\eqn{C_{i} = i^{th} concentration}{Ci = ith concentration} \cr
\eqn{T_{i} = i^{th} time}{Ti = ith time} \cr
\eqn{n = the number of data points} \cr \cr
\strong{Terminal log-linear phase} = The phase in the natural-log transformed concentration-time profile selected
by user at the time of primary parameter computaitons via interactive concentration-time plots(refer to KEL
tab on the front end) \cr \cr  
Set time of last dose TDOSE to 0 and shift T accordingly in calculation of KEL. This impacts the C0 the intercept
used in other paramerter calculations AUCINF \cr \cr
\strong{Equation for KEL}\cr \eqn{KEL = S x -1} \cr \cr 
\strong{Terminal Phase Half-Life Equation} \cr  
\figure{thalf.png} \cr
\eqn{KEL = Terminal Rate Constant} \cr
}
\section{Note}{

If concentrations are less than or equal to zero or 'NA' for a data point, that data point is not used
in calculations. There needs to be atleast 2 data points in the data. If KEL is less than 0 then the function
will return 'ND' for Not Determined. And also you must provide a valid sid with respect to the data.
}

\section{Returns}{

\strong{Vector} \cr 
\itemize{
 \item KEL: maximum observed concentration
 \item KELCO: the intercept on natural log of plasma drug concentration axis (y-intercept)
 \item KELTMLO: intial timepoint used in the calculation of KEL
 \item KELTMHI: final timepoint used in the calculation of KEL
 \item KELNOPT: number of time points used in the calculation of KEL
 \item THALF: terminal phase half-life
}
}

\section{Additional Details}{

If KEL returns NA then TMHI and TMLO both are set to NA as well. If TMLO is greater
than or equal to TMHI, then TMLO is set to NA. If TMHI is less than or equal to TMLO, then TMHI is set
to NA. If KEL returns NA then THALF is set to NA. If THALF is less than or equal to zero, then it is 
set to NA
}

\examples{
##########
## Data ##
#################################
##  SID  ##  TIME  ##   CONC   ## 
#################################
##   30  ##    0   ##   2.89   ##
##   30  ##    1   ##   2.49   ##
##   30  ##    2   ##   2.47   ##
#################################

data <- data.frame(
    SID = ...,
    TIME = ...,
    RESULT = ...
)
#Same data as above, just represented as a dataframe

kel()   
#Error in kel: 'conc' and 'time' vectors are NULL

conc_vector <- data$CONC
time_vector <- data$TIME

kel(conc = conc_vector, time = time_vector)
#        KEL      KELC0    KELTMLO    KELTMHI    KELNOPT      THALF 
# 0.07851918 1.03777163 0.00000000 2.00000000 3.00000000 8.82774397 
 
############
## Data 2 ##
#################################
##  SID  ##  TIME  ##   CONC   ## 
#################################
##   31  ##    0   ##      0   ## 
##   31  ##    1   ##      0   ##
##   31  ##    2   ##      0   ##
#################################

data2 <- data.frame(
    SID = ...,
    TIME = ...,
    RESULT = ...
)
#Same data as above, just represented as a dataframe

conc_vector <- data2$CONC
time_vector <- data2$TIME

kel(conc = conc_vector, time = time_vector)
# KEL KELC0 KELTMLO KELTMHI KELNOPT   THALF 
#  NA    NA      NA      NA       0      NA 

############
## Data 3 ##
#################################
##  SID  ##  TIME  ##   CONC   ## 
#################################
##   32  ##    0   ##   2.19   ## 
##   32  ##    1   ##   2.23   ##
##   32  ##    2   ##   2.04   ##
##   32  ##    3   ##   BLQ    ##
#################################

data3 <- data.frame(
    SID = ...,
    TIME = ...,
    RESULT = ...
)
#Same data as above, just represented as a dataframe

conc_vector <- data3$CONC
time_vector <- data3$TIME

kel(conc = conc_vector, time = time_vector)
#        KEL       KELC0     KELTMLO     KELTMHI     KELNOPT       THALF 
# 0.03547587  0.80176018  0.00000000  2.00000000  3.00000000 19.53855451 

}
\author{
\itemize{
 \item Kevin McConnell
}
}
