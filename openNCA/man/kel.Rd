% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kel.R
\name{kel}
\alias{kel}
\alias{kel_tmlo}
\alias{kel_tmhi}
\alias{kel_nopt}
\title{Terminal or Elimination phase rate constant}
\usage{
kel(data = NULL, map = NULL, flag = NULL)
}
\arguments{
\item{data}{The model data that was generated by \code{\link{model}}}

\item{sid}{The subject ID (either can be the id number or 'all' to get kel for all the subjects)}
}
\description{
This function gets the terminal or elimination phase rate constant, which is described as the absolute
value of the slope of a least-squares linear regression during the terminal phase of the natural-logarithm
(ln) transformed concentration-time profile.
}
\details{
\strong{First calculate slope} \cr  
\figure{kel_eq1.png} \cr
\figure{kel_eq2.png} \cr
\figure{kel_eq3.png} \cr
\eqn{S = Slope} \cr
\eqn{C_{i} = i^{th} concentration}{Ci = ith concentration} \cr
\eqn{T_{i} = i^{th} time}{Ti = ith time} \cr
\eqn{n = the number of data points} \cr \cr
\strong{Terminal log-linear phase} = The phase in the natural-log transformed concentration-time profile selected
by user at the time of primary parameter computaitons via interactive concentration-time plots(refer to KEL
tab on the front end) \cr \cr  
Set time of last dose TDOSE to 0 and shift T accordingly in calculation of KEL. This impacts the C0 the intercept
used in other paramerter calculations AUCINF \cr \cr
\strong{Equation for KEL}\cr \eqn{KEL = S x -1} \cr
}
\section{Note}{

If concentrations are less than or equal to zero or 'NA' for a data point, that data point is not used
in calculations. There needs to be atleast 2 data points in the data. If KEL is less than 0 then the function
will return 'ND' for Not Determined. And also you must provide a valid sid with respect to the data.
}

\section{Returns}{

\strong{Dataset} \cr 
\itemize{
 \item SID: subject identification number
 \item KEL: maximum observed concentration
 \item TMLO: intial timepoint used in the calculation of KEL
 \item TMHI: final timepoint used in the calculation of KEL
 \item NOPT: number of time points used in the calculation of KEL
}
}

\section{Additional Details}{

If KEL returns 'ND' or 'Not Determined' then TMHI and TMLO both are set to 'ND' as well. If TMLO is greater
than or equal to TMHI, then TMLO is set to 'ND. If TMHI is less than or equal to TMLO, then TMHI is set
to 'ND'.
}

\examples{
##########
## Data ##
#################################
##  SID  ##  TIME  ##  RESULT  ##
#################################
##   30  ##    0   ##   2.89   ##
##   30  ##    1   ##   2.49   ##
##   30  ##    2   ##   2.47   ##
##   31  ##    0   ##      0   ##
##   31  ##    1   ##   1.00   ##
##   31  ##    2   ##      0   ##
##   32  ##    0   ##   1.19   ##
##   32  ##    1   ##   1.23   ##
##   32  ##    2   ##   1.34   ##
##   32  ##    4   ##   1.32   ##
#################################

data <- data.frame(
    SID = ...,
    TIME = ...,
    RESULT = ...
)
#Same data as above, just represented as a dataframe

kel()   
#No data found!

kel(data)  
#Object not of class NCA

mod <- model("~/data.csv")  
#Creates an NCA object with data represented in 'data' above
kel(mod)  
#Please specify for which subject you want to get the KEL for!

kel(mod, sid = "all")  
# SID     KEL TMLO  TMHI  NOPT
#  30  0.0785    0     2     3
#  31      ND   ND    ND     1
#  32      ND   ND    ND     4

kel(mod, sid = 31)  
# SID KEL TMLO TMHI NOPT
#  31  ND  ND    ND   1

kel(mod, sid = 10)  
#Invaild subject ID! Subject ID not found in the data provided!

}
\author{
\itemize{
 \item Kevin McConnell
}
}
